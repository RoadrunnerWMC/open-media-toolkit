/*****************************************************************        O P E N      M E D I A     T O O L K I T              V2.5             Copyright Yves Schmid 1996-2003         See www.garagecube.com for more informations about this library.                Author(s): Yves Schmid         OMT is provided under LGPL:           This library is free software; you can redistribute it and/or          modify it under the terms of the GNU Lesser General Public          License as published by the Free Software Foundation; either          version 2.1 of the License, or (at your option) any later version.          This library is distributed in the hope that it will be useful,          but WITHOUT ANY WARRANTY; without even the implied warranty of          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU          Lesser General Public License for more details.          You should have received a copy of the GNU Lesser General Public          License along with this library; if not, write to the Free Software          Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA          The full text of the license can be found in lgpl.txt          ******************************************************************/#include "CTempStream.h"#include "OMediaMemStream.h"#include "LFile.h"OMediaStream *CTempStream::createTempStream(){	return new OMediaMemStream();}void CTempStream::readToTempStream(LFile *src, OMediaStream *dest){	OMediaMemStream	*memstr = (OMediaMemStream*)dest;	SInt32	fileLength;	SInt16	refNum = src->GetDataForkRefNum();		OSErr	err = ::GetEOF(refNum, &fileLength);	void *data;	ThrowIfOSErr_(err);	err = ::SetFPos(refNum, fsFromStart, 0);	ThrowIfOSErr_(err);	OMediaMoveableMem *block = memstr->get_memory_block();		block->setsize(fileLength);	data = block->lock();	err = ::FSRead(refNum, &fileLength, data);	ThrowIfOSErr_(err);	block->unlock();}void CTempStream::writeFromTempStream(LFile *file, OMediaStream *src){	SInt32	fileLength;	OMediaMemStream	*memstr = (OMediaMemStream*)src;	OMediaMoveableMem *block = memstr->get_memory_block();	void *data;		fileLength = block->getsize();		data = block->lock();	file->WriteDataFork(data,fileLength);	block->unlock();}